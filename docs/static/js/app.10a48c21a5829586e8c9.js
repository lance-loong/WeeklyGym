webpackJsonp([1],{"D3+a":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("tvR6");var n=a("qBF2"),s=a.n(n),r=a("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var o=a("VU/8")({name:"App"},i,!1,function(t){a("gsu9")},null,null).exports,l=a("/ocq"),u=a("//Fk"),d=a.n(u),c=a("Zrlr"),p=a.n(c),m=a("wxAW"),h=a.n(m),v=a("mvHQ"),_=a.n(v),f=a("mtWM"),b=a.n(f);var D=function(t,e){return new d.a(function(a,n){var s={query:e},r={method:"post",baseURL:"https://api.github.com",url:"/graphql",timeout:1e4,params:s,data:s,headers:{Authorization:"Bearer "+t,"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};delete r.params,b()(r).then(function(t){200!=t.status?n([{message:"response.status != 200, response.status = "+t.status}]):void 0!=t.data.errors?n(t.data.errors):a(t.data.data)}).catch(function(t){n([{message:"network error !!!"}])})})};function g(t){return escape(_()(t))}function w(t){return JSON.parse(unescape(t))}var y=function(){function t(e,a,n,s){p()(this,t),this.m_szToken=e,this.m_szOwner=a,this.m_szRepository=n,this.m_szDatabaseName=s,this.m_aryExecute=[],this.m_bConnect=!1,this.m_pUser=null,this.m_pRepository=null,this.m_szDatabaseID=null}return h()(t,[{key:"Connect",value:function(){var t=this.m_szToken,e=this.m_szOwner,a=this.m_szRepository,n=this.m_szDatabaseName,s=this;return new d.a(function(r,i){D(t,'query{\nuser(login:"'+e+'"){\n  id\n  name\n}\nrepository(owner:"'+e+'", name:"'+a+'"){\n  id\n  name\n  label(name:"'+n+'"){\n    id\n    name\n  }\n}\n}').then(function(t){var a=t.user,n=t.repository,o=n.label;return null==a?i([{message:"user not create : "+e}]):(s.m_pUser={id:a.id,name:a.name},null==n?i([{message:"repository not create : "+s.m_szRepository}]):(s.m_pRepository={id:n.id,name:n.name},null==o?i([{message:"label not create : "+s.m_szDatabaseName}]):(s.m_szDatabaseID=o.id,s.m_bConnect=!0,void r())))},function(t){i(t)})})}},{key:"AddData",value:function(t){var e=this.m_pUser,a=this.m_szToken,n=this.m_pRepository,s=this.m_szDatabaseID;return new d.a(function(r,i){var o=g(t),l='mutation {\n        createIssue( input: {\n          repositoryId : "'+n.id+'",\n          title : "data",\n          body : "'+o+'",\n          assigneeIds : [ "'+e.id+'" ],\n          labelIds : [ "'+s+'" ]\n        } ){\n          issue{\n            id\n            body\n            updatedAt\n          }\n        }\n      }';D(a,l).then(function(t){var e=t.createIssue.issue;e.data=w(e.body),r(e)},i)})}},{key:"DelData",value:function(t){var e=this.m_szToken;return new d.a(function(a,n){D(e,'mutation{\n        deleteIssue(input:{\n          issueId:"'+t+'"\n        }){\n          clientMutationId\n        }\n      }').then(a,n)})}},{key:"UpdData",value:function(t,e){var a=this.m_szToken;return new d.a(function(n,s){var r=g(e);D(a,'mutation{\n  updateIssue(input:{ id:"'+t+'", body:"'+r+'" }){\n    issue{\n      id\n    }\n  }\n}').then(n,s)})}},{key:"GetDataCount",value:function(){var t=this.m_szOwner,e=this.m_szToken,a=this.m_szRepository,n=this.m_szDatabaseName;return new d.a(function(s,r){D(e,'query{\n  repository(owner:"'+t+'", name:"'+a+'"){\n      issues(labels:"'+n+'"){\n      totalCount\n    }\n  }\n}').then(function(t){console.log(t),s()},r)})}},{key:"GetDataAfter",value:function(t,e){var a=this.m_szOwner,n=this.m_szToken,s=this.m_szRepository,r=this.m_szDatabaseName;return t=t?'"'+t+'"':"null",new d.a(function(i,o){D(n,'query{\n  repository(owner:"'+a+'", name:"'+s+'"){\n    issues(labels:"'+r+'", first:'+e+", after:"+t+"){\n      edges{\n        cursor\n        node{\n          id\n          body\n          updatedAt\n        }\n      }\n    }\n  }\n}").then(function(t){for(var e=t.repository.issues.edges,a=[],n=0;n<e.length;++n){var s=e[n].cursor,r=e[n].node;r.data=w(r.body),r.github_cursor=s,a.push(r)}i(a)},o)})}},{key:"GetAllData",value:function(){var t=this;return new d.a(function(e,a){var n=[];!function e(a,s,r,i){t.GetDataAfter(a,s).then(function(t){for(var a=0;a<t.length;++a)n.push(t[a]);0==t.length?r(n):e(t[t.length-1].github_cursor,s,r,i)},function(t){i(t)})}(null,100,e,a)})}}]),t}(),k={methods:{tableRowClassName:function(t){t.row;var e=t.rowIndex;return 0==e?"":e%2==0?"warning-row":"success-row"},handleClickDel:function(t){var e=this;this.m_pDatabase.DelData(t.id).then(function(){var a=e.tableData.indexOf(t);e.tableData.splice(a,1)},function(t){e.DialogError(t)})},handleClickAdd:function(t,e,a){var n=this,s={name:t,date:e,activity:a};this.m_pDatabase.AddData(s).then(function(t){n.tableData.push(t)},function(t){n.DialogError(t)})},Dialog:function(t){this.pDialog.message=t,this.pDialog.visible=!0},DialogError:function(t){for(var e="",a=0;a<t.length;++a)e+=t[a].message+"<br >";this.Dialog(e)}},data:function(){return{pDialog:{visible:!1,message:""},AddDate:"2020-01-09T13:30:35.863Z",AddName:"",AddGym:"",tableData:[],tableStatistics:[]}},watch:{tableData:function(t){for(var e=this.tableData,a={},n=0;n<e.length;++n){var s=e[n].data.name;e[n].data.date,e[n].data.activity;a[s]||(a[s]={name:"",join_date:"",train_total:0,train_cur_week:0,amount:0,amount_total:0,achievement_percentage:"",achievement_percentage_total:""}),++a[s].train_total}for(var s in this.tableStatistics=[],a){var r=a[s];r.name=s,this.tableStatistics.push(r)}}},mounted:function(){var t=new y("6b4ea19d5c26e469e21d5ae4bd991d7a1ca97d35","lance-loong","WeeklyGym","database");this.m_pDatabase=t;var e=this;t.Connect().then(function(e){return t.GetAllData()},function(t){e.DialogError(t)}).then(function(t){for(var a=0;a<t.length;++a)e.tableData.push(t[a])},function(t){e.DialogError(t)})}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"block"},[a("h1",[t._v("统计数据")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableStatistics,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"join_date",label:"加入时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"train_total",label:"总运动次数",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"train_cur_week",label:"当前周运动次数",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"amount",label:"当前周贡献金额",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"amount_total",label:"总贡献金额",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"achievement_percentage",label:"成就度",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"achievement_percentage_total",label:"总成就度"}})],1),t._v(" "),a("el-divider"),t._v(" "),a("h1",[t._v("添加数据")]),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"名字"},model:{value:t.AddName,callback:function(e){t.AddName=e},expression:"AddName"}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期"},model:{value:t.AddDate,callback:function(e){t.AddDate=e},expression:"AddDate"}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"运动"},model:{value:t.AddGym,callback:function(e){t.AddGym=e},expression:"AddGym"}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{on:{click:function(e){return t.handleClickAdd(t.AddName,t.AddDate,t.AddGym)}}},[t._v("添加运动记录")])],1)],1),t._v(" "),a("el-divider"),t._v(" "),a("h1",[t._v("数据列表")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"","row-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{prop:"data.name",label:"姓名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.data.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"data.date",label:"时间",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-date-picker",{attrs:{clearable:!1,align:"right",type:"date",placeholder:"选择日期"},model:{value:e.row.data.date,callback:function(a){t.$set(e.row.data,"date",a)},expression:"scope.row.data.date"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"data.activity",label:"活动",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleClickDel(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"提示",visible:t.pDialog.visible,width:"30%"},on:{"update:visible":function(e){return t.$set(t.pDialog,"visible",e)}}},[a("span",[t._v(t._s(t.pDialog.message))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.pDialog.visible=!1}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var z=a("VU/8")(k,A,!1,function(t){a("D3+a")},"data-v-e61f049e",null).exports;r.default.use(l.a);var R=new l.a({routes:[{path:"/",name:"HelloWorld",component:z}]});r.default.use(s.a),new r.default({el:"#app",router:R,components:{App:o},template:"<App/>"})},gsu9:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.10a48c21a5829586e8c9.js.map